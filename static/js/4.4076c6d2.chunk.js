(this["webpackJsonpcra-tasks"]=this["webpackJsonpcra-tasks"]||[]).push([[4],{268:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),c=a(243),l=a(265),i=a(244),u=a(247),o=a(252),s=function(e){var t={};return e.name?e.name.length<3&&(t.name="Must have min 3 characters"):t.name="Required",t},d=function(e){var t=e.addTask,a=e.onCancel,n=(new Date).toISOString().slice(0,10),c=Object(o.a)({initialValues:{name:"",priority:!1,date:n,done:!1,finishDate:null},validate:s,onSubmit:function(e,a){var n=a.resetForm;t(e),n()}});return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:c.handleSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{id:"name",name:"name",type:"text",onChange:c.handleChange,onBlur:c.handleBlur,value:c.values.name,className:"form-control",placeholder:"add task"}),c.errors.name?r.a.createElement("div",{className:"alert alert-danger"},c.errors.name):null),r.a.createElement("div",{className:"form-group form-check"},r.a.createElement("input",{id:"priority",name:"priority",type:"checkbox",onChange:c.handleChange,onBlur:c.handleBlur,value:c.values.priority,className:"form-check-input"}),r.a.createElement("label",{className:"form-check-label",htmlFor:"priority"},"priorytet")),r.a.createElement("button",{className:"btn btn-block btn-outline-warning",type:"submit"},"Dodaj"),r.a.createElement("button",{className:"btn btn-block btn-outline-danger",onClick:a},"Anuluj")))},m=function(e){var t={};return e.name?e.name.length<3&&(t.name="Must have min 3 characters"):t.name="Required",t},E=function(e){var t=e.update,a=e.task,n=e.cancelEdit,l=e.index,s=a.name,d=Object(o.a)({initialValues:{name:s},validate:m,onSubmit:function(e){var n=e.name;t(Object(c.a)(Object(c.a)({},a),{},{name:n}))}});return r.a.createElement(r.a.Fragment,null,r.a.createElement("td",null,l+1),r.a.createElement("td",null,r.a.createElement("input",{id:"name",name:"name",type:"text",onChange:d.handleChange,onBlur:d.handleBlur,value:d.values.name,className:"form-control"}),d.errors.name?r.a.createElement("div",{className:"alert alert-danger"},d.errors.name):null),r.a.createElement("td",null),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-outline-warning",type:"submit",onClick:d.handleSubmit},r.a.createElement(i.a,{icon:u.b})),r.a.createElement("button",{className:"btn btn-outline-danger",onClick:n},r.a.createElement(i.a,{icon:u.e}))))};var b=function(e){var t=e.index,a=e.task,n=e.onDone,c=e.onEdit,l=e.onDelete,o=e.onUpdate,s=e.editMode,d=e.currentEditTask,m=e.cancelEdit,b=a.name,f=a.done,h=a.finishDate,k=a.priority,p=a.date,v=f,T={};return f&&(T.textDecoration="line-through",T.backgroundColor="orange"),k&&(T.color="red"),r.a.createElement("tr",{style:T},a.id===d?r.a.createElement(E,{update:o,task:a,cancelEdit:m,index:t}):r.a.createElement(r.a.Fragment,null,r.a.createElement("td",null,t+1),r.a.createElement("td",{onClick:n},b),r.a.createElement("td",null,f?h:p),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-sm btn-outline-secondary mr-1",onClick:c,disabled:v||s},r.a.createElement(i.a,{icon:u.a})),r.a.createElement("button",{className:"btn btn-sm btn-outline-danger",onClick:l,disabled:s},r.a.createElement(i.a,{icon:u.d})))," "))};var f=function(e){var t=e.tasks,a=e.del,n=e.done,c=e.edit,l=e.editMode,i=e.onUpdate,u=e.currentEditTask,o=e.cancelEdit;return r.a.createElement("table",{className:"table table-info table-hover table-striped table-responsive{-sm|-md|-lg|-xl}"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"#"),r.a.createElement("th",null,"task name"),r.a.createElement("th",null,"date"),r.a.createElement("th",null,"edit / del"))),r.a.createElement("tbody",null,t.map((function(e,t){return r.a.createElement(b,{key:e.id,index:t,task:e,onDelete:function(){return a(e)},onDone:function(){return n(e)},onEdit:function(){return c(e)},cancelEdit:o,editMode:l,onUpdate:i,currentEditTask:u})}))))},h=a(54),k=a.n(h),p=a(114),v=a(269),T=a(115),O=[{id:1,date:"2020-02-03",done:!1,finishDate:null,name:"nauczy\u0107 si\u0119 js es 6",priority:!1},{id:2,date:"2020-02-04",done:!1,finishDate:null,name:"nauczy\u0107 si\u0119 biblioteki axios",priority:!0},{id:3,date:"2020-03-03",done:!1,finishDate:null,name:"zainstalowa\u0107 linuxa",priority:!1},{id:4,date:"2020-04-09",done:!1,finishDate:null,name:"zrobi\u0107 api w laravelu",priority:!1}];function j(e){var t=O.findIndex((function(t){return t.id===e}));if(t<0)throw new Error("task o podanym id nie istnieje");return t}var g={getAllTasks:function(){return Object(p.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(T.a)(200);case 2:return e.abrupt("return",[].concat(O));case 3:case"end":return e.stop()}}),e)})))()},addTask:function(e){return Object(p.a)(k.a.mark((function t(){var a;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(T.a)(200);case 2:return a=Object(c.a)({id:Object(v.a)()},e),O.push(a),t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})))()},replaceTask:function(e){return Object(p.a)(k.a.mark((function t(){var a,n;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(T.a)(200);case 2:if(e.id){t.next=4;break}throw new Error("task has to have an id to be updated");case 4:return a=j(e.id),n=Object(c.a)({},e),O[a]=n,t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)})))()},finishTask:function(e){return Object(p.a)(k.a.mark((function t(){var a,n;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(T.a)(200);case 2:if(e.id){t.next=4;break}throw new Error("task has to have an id to be finished");case 4:return a=Object(c.a)(Object(c.a)({},e),{},{done:!e.done,finishDate:e.done?(new Date).toISOString().slice(0,10):null}),n=j(e.id),O[n]=a,t.abrupt("return",a);case 8:case"end":return t.stop()}}),t)})))()},removeTask:function(e){return Object(p.a)(k.a.mark((function t(){var a;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(T.a)(200);case 2:if(e.id){t.next=4;break}throw new Error("task has to have an id to be deleted");case 4:a=j(e.id),O.splice(a,1);case 6:case"end":return t.stop()}}),t)})))()},getTasksByFullTextSearch:function(e){return Object(p.a)(k.a.mark((function t(){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(T.a)(200);case 2:return t.abrupt("return",e);case 3:case"end":return t.stop()}}),t)})))()}},y=a(266),S={tasks:[],searchQuery:"",editMode:!1,loading:!0,error:null,currentEditTask:null,create:!1},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"SET_TASKS":var a=t.tasks;return Object(c.a)(Object(c.a)({},e),{},{tasks:a});case"SEARCH_TASK":var n=e.tasks.filter((function(t){return t.name.toLowerCase().includes(e.searchQuery)}));return Object(c.a)(Object(c.a)({},e),{},{tasks:n});case"ADD_TASK":var r=t.task,l=[].concat(Object(y.a)(e.tasks),[r]);return Object(c.a)(Object(c.a)({},e),{},{tasks:l,create:!1});case"REPLACE_TASK":var i=t.replacedTask,u=e.tasks.map((function(e){return e.id===i.id?i:e}));return Object(c.a)(Object(c.a)({},e),{},{tasks:u,editMode:!1,currentEditTask:null});case"DELETE_TASK":var o=t.removedTask,s=e.tasks.filter((function(e){return e.id!==o.id}));return Object(c.a)(Object(c.a)({},e),{},{tasks:s});case"TASK_EDIT_START":var d=t.task;return Object(c.a)(Object(c.a)({},e),{},{task:d,currentEditTask:d.id,editMode:!0});case"TASK_EDIT_STOP":return Object(c.a)(Object(c.a)({},e),{},{currentEditTask:null,editMode:!1});case"COMPLETE_TASK":var m=t.completedTask,E=e.tasks.map((function(e){return e.id===m.id&&(e.done=!e.done,e.finishDate=e.done?(new Date).toISOString().slice(0,10):null),e}));return Object(c.a)(Object(c.a)({},e),{},{tasks:E});case"SET_ERROR":var b=t.error;return Object(c.a)(Object(c.a)({},e),{},{error:b});case"LOADING":return Object(c.a)(Object(c.a)({},e),{},{loading:!1});case"SEARCH_INPUT":var f=t.payload;return Object(c.a)(Object(c.a)({},e),{},{searchQuery:f});case"CREATE_MODE":return Object(c.a)(Object(c.a)({},e),{},{create:!0});case"CANCEL_CREATE":return Object(c.a)(Object(c.a)({},e),{},{create:!1});default:return e}};var A=function(e){var t=e.search;return r.a.createElement("div",{className:"form-group mt-4"},r.a.createElement("input",{type:"text",placeholder:"search task",className:"form-control",onInput:t}))};var x=function(){var e=Object(n.useReducer)(w,void 0,w),t=Object(l.a)(e,2),a=t[0],o=t[1];Object(n.useEffect)((function(){g.getAllTasks().then((function(e){return o(function(e){return{type:"SET_TASKS",tasks:e}}(e))})).catch((function(e){return o(function(e){return{type:"SET_ERROR",error:e}}(e))})).finally((function(){return o({type:"LOADING"})})),g.getTasksByFullTextSearch(a.searchQuery).then((function(){o({type:"SEARCH_TASK"})}))}),[a.searchQuery]);var s=a.tasks,m=a.editMode,E=a.error,b=a.loading,h=a.create,k=a.currentEditTask;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"card bg-dark text-white col-{-sm|-md|-lg|-xl}"},r.a.createElement("div",{className:"card-body"},h?r.a.createElement(d,{addTask:function(e){try{g.addTask(e).then((function(e){return o(function(e){return{type:"ADD_TASK",task:e}}(e))}))}catch(E){console.log("Jest b\u0142\u0105d przy tworzeniu taska:",E)}},onCancel:function(){return o({type:"CANCEL_CREATE"})}}):r.a.createElement(r.a.Fragment,null,r.a.createElement(A,{search:function(e){return o(function(e){return{type:"SEARCH_INPUT",payload:e.target.value.toLowerCase()}}(e))}}),r.a.createElement("button",{onClick:function(){return o({type:"CREATE_MODE"})},className:"btn btn-outline-warning"},r.a.createElement(i.a,{icon:u.c}))))),E?"Nie uda\u0142o si\u0119 za\u0142adowa\u0107 :(":null,b?"taski si\u0119 \u0142aduj\u0105...":null,r.a.createElement(f,{loading:b,tasks:s,del:function(e){g.removeTask(e).then((function(){return o({type:"DELETE_TASK",removedTask:e})}))},done:function(e){g.finishTask(e).then((function(){return o({type:"COMPLETE_TASK",completedTask:e})}))},edit:function(e){o(function(e){return{type:"TASK_EDIT_START",task:e}}(e))},editMode:m,currentEditTask:k,cancelEdit:function(){return o({type:"TASK_EDIT_STOP"})},onUpdate:function(e){var t=Object(c.a)(Object(c.a)({},a.task),e);g.replaceTask(t).then((function(e){return o(function(e){return{type:"REPLACE_TASK",replacedTask:e}}(e))}))}}))};var C=function(e){var t=e.children;if(t.length<1)throw new Error("Header has to have at least one child!");return r.a.createElement("header",{className:"card bg-warning text-white"},t)},N=a(56),D=a.n(N),_=a(113);var R=function(e){var t,a=e.onLogout,c=Object(n.useContext)(_.a).accessToken;return r.a.createElement(r.a.Fragment,null,c?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"card-body"},r.a.createElement("h3",{className:"card-title text-center"},"TASKS LIST"),r.a.createElement("p",{className:"card-text text-right"},"Witaj ",(t=c,D.a.decode(t).email)," /",r.a.createElement("a",{href:"#",className:"",onClick:a},"wyloguj si\u0119")))):null)};t.default=function(e){var t=e.onLogout;return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,null,r.a.createElement(R,{onLogout:t})),r.a.createElement(x,null))}}}]);
//# sourceMappingURL=4.4076c6d2.chunk.js.map